{"ast":null,"code":"import axios from 'axios';\n\n// Set the base URL for API requests\nconst BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n\n// Create an axios instance\nconst api = axios.create({\n  baseURL: BASE_URL,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// API for RESTful endpoints\nexport const chatAPI = {\n  // Send a message to the chatbot\n  sendMessage: async message => {\n    try {\n      const response = await api.post('/api/chat', {\n        message\n      });\n      return response.data;\n    } catch (error) {\n      console.error('Error sending message:', error);\n      throw error;\n    }\n  },\n  // Get conversation history\n  getHistory: async () => {\n    try {\n      const response = await api.get('/api/history');\n      return response.data.history;\n    } catch (error) {\n      console.error('Error getting history:', error);\n      throw error;\n    }\n  },\n  // Reset conversation\n  resetConversation: async () => {\n    try {\n      const response = await api.post('/api/reset');\n      return response.data;\n    } catch (error) {\n      console.error('Error resetting conversation:', error);\n      throw error;\n    }\n  },\n  // Check if a plot file exists\n  checkPlotExists: async filename => {\n    try {\n      const response = await api.get(`/check-plot/${filename}`);\n      return response.data.exists;\n    } catch (error) {\n      console.error('Error checking plot:', error);\n      return false;\n    }\n  },\n  // Get the full URL for a plot\n  getPlotUrl: plotPath => {\n    if (!plotPath) return null;\n\n    // If it's already a full URL, return it\n    if (plotPath.startsWith('http')) return plotPath;\n\n    // If it's a relative path, combine with base URL\n    // Handle both Unix and Windows style paths\n    const normalizedPath = plotPath.replace(/\\\\/g, '/');\n    const filename = normalizedPath.split('/').pop();\n    return `${BASE_URL}/plots/${filename}`;\n  }\n};\n\n// WebSocket connection management\nlet socket = null;\nlet messageCallbacks = [];\nexport const chatSocket = {\n  // Connect to WebSocket\n  connect: clientId => {\n    if (socket) {\n      socket.close();\n    }\n    const wsUrl = BASE_URL.replace(/^http/, 'ws');\n    socket = new WebSocket(`${wsUrl}/ws/${clientId}`);\n    console.log(`Connecting to WebSocket at ${wsUrl}/ws/${clientId}`);\n    socket.onopen = () => {\n      console.log('WebSocket connected');\n    };\n    socket.onmessage = event => {\n      try {\n        const data = JSON.parse(event.data);\n        console.log('WebSocket message received:', data);\n        messageCallbacks.forEach(callback => callback(data));\n      } catch (error) {\n        console.error('Error parsing WebSocket message:', error);\n      }\n    };\n    socket.onerror = error => {\n      console.error('WebSocket error:', error);\n    };\n    socket.onclose = () => {\n      console.log('WebSocket disconnected');\n    };\n    return {\n      // Send a message through WebSocket\n      sendMessage: message => {\n        if (socket.readyState === WebSocket.OPEN) {\n          console.log('Sending message via WebSocket:', message);\n          socket.send(JSON.stringify({\n            message\n          }));\n        } else {\n          console.error('WebSocket not connected, readyState:', socket.readyState);\n        }\n      },\n      // Reset conversation through WebSocket\n      resetConversation: () => {\n        if (socket.readyState === WebSocket.OPEN) {\n          console.log('Resetting conversation via WebSocket');\n          socket.send(JSON.stringify({\n            reset: true\n          }));\n        } else {\n          console.error('WebSocket not connected for reset');\n        }\n      },\n      // Add a message callback\n      addMessageCallback: callback => {\n        messageCallbacks.push(callback);\n      },\n      // Remove a message callback\n      removeMessageCallback: callback => {\n        messageCallbacks = messageCallbacks.filter(cb => cb !== callback);\n      },\n      // Check connection status\n      isConnected: () => {\n        return socket && socket.readyState === WebSocket.OPEN;\n      },\n      // Disconnect WebSocket\n      disconnect: () => {\n        if (socket) {\n          socket.close();\n          socket = null;\n        }\n      }\n    };\n  }\n};\nexport default {\n  chatAPI,\n  chatSocket\n};","map":{"version":3,"names":["axios","BASE_URL","process","env","REACT_APP_API_URL","api","create","baseURL","headers","chatAPI","sendMessage","message","response","post","data","error","console","getHistory","get","history","resetConversation","checkPlotExists","filename","exists","getPlotUrl","plotPath","startsWith","normalizedPath","replace","split","pop","socket","messageCallbacks","chatSocket","connect","clientId","close","wsUrl","WebSocket","log","onopen","onmessage","event","JSON","parse","forEach","callback","onerror","onclose","readyState","OPEN","send","stringify","reset","addMessageCallback","push","removeMessageCallback","filter","cb","isConnected","disconnect"],"sources":["/Users/akshajnevgi/Desktop/Agentic_Healthcare_Chatbot/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\n// Set the base URL for API requests\nconst BASE_URL = process.env.REACT_APP_API_URL || 'http://localhost:8000';\n\n// Create an axios instance\nconst api = axios.create({\n  baseURL: BASE_URL,\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// API for RESTful endpoints\nexport const chatAPI = {\n  // Send a message to the chatbot\n  sendMessage: async (message) => {\n    try {\n      const response = await api.post('/api/chat', { message });\n      return response.data;\n    } catch (error) {\n      console.error('Error sending message:', error);\n      throw error;\n    }\n  },\n\n  // Get conversation history\n  getHistory: async () => {\n    try {\n      const response = await api.get('/api/history');\n      return response.data.history;\n    } catch (error) {\n      console.error('Error getting history:', error);\n      throw error;\n    }\n  },\n\n  // Reset conversation\n  resetConversation: async () => {\n    try {\n      const response = await api.post('/api/reset');\n      return response.data;\n    } catch (error) {\n      console.error('Error resetting conversation:', error);\n      throw error;\n    }\n  },\n  \n  // Check if a plot file exists\n  checkPlotExists: async (filename) => {\n    try {\n      const response = await api.get(`/check-plot/${filename}`);\n      return response.data.exists;\n    } catch (error) {\n      console.error('Error checking plot:', error);\n      return false;\n    }\n  },\n  \n  // Get the full URL for a plot\n  getPlotUrl: (plotPath) => {\n    if (!plotPath) return null;\n    \n    // If it's already a full URL, return it\n    if (plotPath.startsWith('http')) return plotPath;\n    \n    // If it's a relative path, combine with base URL\n    // Handle both Unix and Windows style paths\n    const normalizedPath = plotPath.replace(/\\\\/g, '/');\n    const filename = normalizedPath.split('/').pop();\n    return `${BASE_URL}/plots/${filename}`;\n  }\n};\n\n// WebSocket connection management\nlet socket = null;\nlet messageCallbacks = [];\n\nexport const chatSocket = {\n  // Connect to WebSocket\n  connect: (clientId) => {\n    if (socket) {\n      socket.close();\n    }\n\n    const wsUrl = BASE_URL.replace(/^http/, 'ws');\n    socket = new WebSocket(`${wsUrl}/ws/${clientId}`);\n    \n    console.log(`Connecting to WebSocket at ${wsUrl}/ws/${clientId}`);\n\n    socket.onopen = () => {\n      console.log('WebSocket connected');\n    };\n\n    socket.onmessage = (event) => {\n      try {\n        const data = JSON.parse(event.data);\n        console.log('WebSocket message received:', data);\n        messageCallbacks.forEach(callback => callback(data));\n      } catch (error) {\n        console.error('Error parsing WebSocket message:', error);\n      }\n    };\n\n    socket.onerror = (error) => {\n      console.error('WebSocket error:', error);\n    };\n\n    socket.onclose = () => {\n      console.log('WebSocket disconnected');\n    };\n\n    return {\n      // Send a message through WebSocket\n      sendMessage: (message) => {\n        if (socket.readyState === WebSocket.OPEN) {\n          console.log('Sending message via WebSocket:', message);\n          socket.send(JSON.stringify({ message }));\n        } else {\n          console.error('WebSocket not connected, readyState:', socket.readyState);\n        }\n      },\n\n      // Reset conversation through WebSocket\n      resetConversation: () => {\n        if (socket.readyState === WebSocket.OPEN) {\n          console.log('Resetting conversation via WebSocket');\n          socket.send(JSON.stringify({ reset: true }));\n        } else {\n          console.error('WebSocket not connected for reset');\n        }\n      },\n\n      // Add a message callback\n      addMessageCallback: (callback) => {\n        messageCallbacks.push(callback);\n      },\n\n      // Remove a message callback\n      removeMessageCallback: (callback) => {\n        messageCallbacks = messageCallbacks.filter(cb => cb !== callback);\n      },\n\n      // Check connection status\n      isConnected: () => {\n        return socket && socket.readyState === WebSocket.OPEN;\n      },\n\n      // Disconnect WebSocket\n      disconnect: () => {\n        if (socket) {\n          socket.close();\n          socket = null;\n        }\n      }\n    };\n  }\n};\n\nexport default { chatAPI, chatSocket };"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}